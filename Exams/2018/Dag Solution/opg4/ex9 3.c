// micro-C example 9 -- return a result via a pointer argument

void main(int i) {
  int r;
  fac(i, &r);
  print r;
}

void fac(int n, int *res) {
  // print &n;			// Show n's address
  if (n == 0)
    *res = 1;
  else {
    int tmp;
    fac(n-1, &tmp);
    *res = tmp * n;
  }
}


java Machinetrace ex9.out 2                                                                                                                                                                                                                                                                               14:51:34 
[ ]{0: LDARGS}
[ 2 ]{1: CALL 1 5}
[ 4 -999 2 ]{5: INCSP 1}
[ 4 -999 2 0 ]{7: GETBP}
[ 4 -999 2 0 2 ]{8: CSTI 0}
[ 4 -999 2 0 2 0 ]{10: ADD}
[ 4 -999 2 0 2 ]{11: LDI}
[ 4 -999 2 0 2 ]{12: GETBP}
[ 4 -999 2 0 2 2 ]{13: CSTI 1}
[ 4 -999 2 0 2 2 1 ]{15: ADD}
[ 4 -999 2 0 2 3 ]{16: CALL 2 33}
[ 4 -999 2 0 19 2 2 3 ]{33: GETBP}
[ 4 -999 2 0 19 2 2 3 6 ]{34: CSTI 0}
[ 4 -999 2 0 19 2 2 3 6 0 ]{36: ADD}
[ 4 -999 2 0 19 2 2 3 6 ]{37: LDI}
[ 4 -999 2 0 19 2 2 3 2 ]{38: CSTI 0}
[ 4 -999 2 0 19 2 2 3 2 0 ]{40: EQ}
[ 4 -999 2 0 19 2 2 3 0 ]{41: IFZERO 55}
[ 4 -999 2 0 19 2 2 3 ]{55: INCSP 1}
[ 4 -999 2 0 19 2 2 3 0 ]{57: GETBP}
[ 4 -999 2 0 19 2 2 3 0 6 ]{58: CSTI 0}
[ 4 -999 2 0 19 2 2 3 0 6 0 ]{60: ADD}
[ 4 -999 2 0 19 2 2 3 0 6 ]{61: LDI}
[ 4 -999 2 0 19 2 2 3 0 2 ]{62: CSTI 1}
[ 4 -999 2 0 19 2 2 3 0 2 1 ]{64: SUB}
[ 4 -999 2 0 19 2 2 3 0 1 ]{65: GETBP}
[ 4 -999 2 0 19 2 2 3 0 1 6 ]{66: CSTI 2}
[ 4 -999 2 0 19 2 2 3 0 1 6 2 ]{68: ADD}
[ 4 -999 2 0 19 2 2 3 0 1 8 ]{69: CALL 2 33}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 ]{33: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 11 ]{34: CSTI 0}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 11 0 ]{36: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 11 ]{37: LDI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 ]{38: CSTI 0}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 0 ]{40: EQ}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 ]{41: IFZERO 55}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 ]{55: INCSP 1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 ]{57: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 11 ]{58: CSTI 0}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 11 0 ]{60: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 11 ]{61: LDI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 1 ]{62: CSTI 1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 1 1 ]{64: SUB}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 0 ]{65: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 0 11 ]{66: CSTI 2}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 0 11 2 ]{68: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 0 13 ]{69: CALL 2 33}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 ]{33: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 16 ]{34: CSTI 0}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 16 0 ]{36: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 16 ]{37: LDI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 0 ]{38: CSTI 0}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 0 0 ]{40: EQ}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 1 ]{41: IFZERO 55}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 ]{43: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 16 ]{44: CSTI 1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 16 1 ]{46: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 17 ]{47: LDI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 13 ]{48: CSTI 1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 0 72 11 0 13 13 1 ]{50: STI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 72 11 0 13 1 ]{51: INCSP -1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 72 11 0 13 ]{53: GOTO 95}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 72 11 0 13 ]{95: INCSP 0}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 72 11 0 13 ]{97: RET 1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 13 ]{72: INCSP -1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 ]{74: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 11 ]{75: CSTI 1}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 11 1 ]{77: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 12 ]{78: LDI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 ]{79: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 11 ]{80: CSTI 2}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 11 2 ]{82: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 13 ]{83: LDI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 1 ]{84: GETBP}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 1 11 ]{85: CSTI 0}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 1 11 0 ]{87: ADD}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 1 11 ]{88: LDI}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 1 1 ]{89: MUL}
[ 4 -999 2 0 19 2 2 3 0 72 6 1 8 1 8 1 ]{90: STI}
[ 4 -999 2 0 19 2 2 3 1 72 6 1 8 1 1 ]{91: INCSP -1}
[ 4 -999 2 0 19 2 2 3 1 72 6 1 8 1 ]{93: INCSP -1}
[ 4 -999 2 0 19 2 2 3 1 72 6 1 8 ]{95: INCSP 0}
[ 4 -999 2 0 19 2 2 3 1 72 6 1 8 ]{97: RET 1}
[ 4 -999 2 0 19 2 2 3 1 8 ]{72: INCSP -1}
[ 4 -999 2 0 19 2 2 3 1 ]{74: GETBP}
[ 4 -999 2 0 19 2 2 3 1 6 ]{75: CSTI 1}
[ 4 -999 2 0 19 2 2 3 1 6 1 ]{77: ADD}
[ 4 -999 2 0 19 2 2 3 1 7 ]{78: LDI}
[ 4 -999 2 0 19 2 2 3 1 3 ]{79: GETBP}
[ 4 -999 2 0 19 2 2 3 1 3 6 ]{80: CSTI 2}
[ 4 -999 2 0 19 2 2 3 1 3 6 2 ]{82: ADD}
[ 4 -999 2 0 19 2 2 3 1 3 8 ]{83: LDI}
[ 4 -999 2 0 19 2 2 3 1 3 1 ]{84: GETBP}
[ 4 -999 2 0 19 2 2 3 1 3 1 6 ]{85: CSTI 0}
[ 4 -999 2 0 19 2 2 3 1 3 1 6 0 ]{87: ADD}
[ 4 -999 2 0 19 2 2 3 1 3 1 6 ]{88: LDI}
[ 4 -999 2 0 19 2 2 3 1 3 1 2 ]{89: MUL}
[ 4 -999 2 0 19 2 2 3 1 3 2 ]{90: STI}
[ 4 -999 2 2 19 2 2 3 1 2 ]{91: INCSP -1}
[ 4 -999 2 2 19 2 2 3 1 ]{93: INCSP -1}
[ 4 -999 2 2 19 2 2 3 ]{95: INCSP 0}
[ 4 -999 2 2 19 2 2 3 ]{97: RET 1}
[ 4 -999 2 2 3 ]{19: INCSP -1}
[ 4 -999 2 2 ]{21: GETBP}
[ 4 -999 2 2 2 ]{22: CSTI 1}
[ 4 -999 2 2 2 1 ]{24: ADD}
[ 4 -999 2 2 3 ]{25: LDI}
[ 4 -999 2 2 2 ]{26: PRINTI}
2 [ 4 -999 2 2 2 ]{27: INCSP -1}
[ 4 -999 2 2 ]{29: INCSP -1}
[ 4 -999 2 ]{31: RET 0}
[ 2 ]{4: STOP}